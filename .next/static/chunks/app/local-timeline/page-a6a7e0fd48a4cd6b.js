(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[764],{8986:function(e,t,l){Promise.resolve().then(l.bind(l,8185))},8185:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return o}});var s=l(7437),n=l(2265),a=l(2324),r=l(4890),i=l.n(r);function o(){let[e,t]=(0,n.useState)([]),[l,r]=(0,n.useState)(!0),[o,c]=(0,n.useState)(null),u=(0,n.useCallback)(async()=>{r(!0),c(null);try{let e=await fetch("/api/fediverse/local-timeline");if(e.ok){let l=await e.json();t(l)}else{let t=await e.json();c(t.error||"ローカルタイムラインの取得に失敗しました。")}}catch(e){c("予期せぬエラーが発生しました。"),console.error(e)}finally{r(!1)}},[]);return((0,n.useEffect)(()=>{u();let e=setInterval(()=>{u()},1e4);return()=>clearInterval(e)},[u]),l)?(0,s.jsx)("div",{className:i().loadingMessage,children:"ローカルタイムラインを読み込み中..."}):o?(0,s.jsx)("div",{className:i().errorMessage,children:o}):(0,s.jsxs)("div",{className:i().container,children:[(0,s.jsx)("h1",{className:i().title,children:"ZenSky タイムライン"}),0===e.length?(0,s.jsx)("p",{className:i().noPosts,children:"まだ投稿がありません。"}):(0,s.jsx)(a.T,{posts:e,onPostDeleted:u})]})}},2324:function(e,t,l){"use strict";l.d(t,{T:function(){return u}});var s=l(7437),n=l(2265),a=l(8562),r=l.n(a),i=l(9361),o=l(8211),c=l(1310);let u=e=>{let{posts:t,onPostDeleted:l}=e,{showToast:a}=(0,o.p)(),{showPopover:u}=(0,c.t)(),[d,_]=(0,n.useState)(null),[f,h]=(0,n.useState)(null),[g,m]=(0,n.useState)(null);return((0,n.useEffect)(()=>{let e=localStorage.getItem("token");if(e)try{let t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),l=JSON.parse(window.atob(t));_(l.userId)}catch(e){console.error("トークンのデコードに失敗しました",e),_(null)}},[t]),t&&0!==t.length)?(0,s.jsx)("div",{className:r().timelineContainer,children:t.map(e=>(0,s.jsx)(i.S,{post:e,onPostDeleted:l,currentUserId:d},e.id))}):(0,s.jsx)("div",{className:r().noPostsMessage,children:(0,s.jsx)("p",{children:"まだ投稿がありません。最初の投稿をしてみましょう！"})})}},4890:function(e){e.exports={container:"local-timeline_container__llRxH",title:"local-timeline_title__MrdLE",loadingMessage:"local-timeline_loadingMessage__gNrU0",errorMessage:"local-timeline_errorMessage__c8_PE",noPosts:"local-timeline_noPosts__46da6"}}},function(e){e.O(0,[370,803,555,361,971,117,744],function(){return e(e.s=8986)}),_N_E=e.O()}]);