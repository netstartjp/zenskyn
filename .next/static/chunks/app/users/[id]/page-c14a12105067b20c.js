(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[676],{9903:function(e,s,t){Promise.resolve().then(t.bind(t,6871))},9376:function(e,s,t){"use strict";var r=t(5475);t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})},6871:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return u}});var r=t(7437),a=t(2265),l=t(9376),n=t(7648),i=t(9654),o=t.n(i),c=t(2324);function u(e){let{params:s}=e,t=(0,l.useRouter)(),i=s.id,[u,d]=(0,a.useState)(null),[_,p]=(0,a.useState)(!0),[m,f]=(0,a.useState)(null),[h,g]=(0,a.useState)(!1),[N,j]=(0,a.useState)(null),x=(0,a.useCallback)(async()=>{p(!0),f(null);let e=localStorage.getItem("token");if(e)try{let s=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),t=JSON.parse(window.atob(s));j(t.userId)}catch(e){console.error("トークンのデコードに失敗しました",e),j(null)}try{let e=await fetch("/api/users/".concat(i));if(e.ok){let s=await e.json();d(s)}else{let s=await e.json();f(s.error||"ユーザープロフィールの取得に失敗しました。")}}catch(e){f("予期せぬエラーが発生しました。"),console.error(e)}finally{p(!1)}},[i]);return((0,a.useEffect)(()=>{x()},[x]),_)?(0,r.jsx)("div",{className:o().loadingMessage,children:"プロフィールを読み込み中..."}):m?(0,r.jsx)("div",{className:o().errorMessage,children:m}):u?(0,r.jsxs)("div",{className:o().container,children:[(0,r.jsxs)("header",{className:o().header,children:[(0,r.jsx)("h1",{className:o().title,children:"ユーザープロフィール"}),(0,r.jsx)(n.default,{href:"/",children:(0,r.jsx)("button",{className:o().backButton,children:"ホームに戻る"})})]}),(0,r.jsxs)("main",{className:o().mainContent,children:[(0,r.jsxs)("section",{className:o().profileCard,children:[(0,r.jsxs)("div",{className:o().profileHeader,children:[u.profileImageUrl&&(0,r.jsx)("img",{src:u.profileImageUrl,alt:"プロフィール画像",className:o().profileImage}),(0,r.jsx)("h2",{className:o().profileName,children:u.name||"名無しユーザー"}),u.customId&&(0,r.jsxs)("p",{className:o().profileCustomId,children:["@",u.customId]})," ",u.id===N&&(0,r.jsx)("button",{onClick:()=>t.push("/settings"),className:o().editButton,children:"プロフィールを編集"})]}),(0,r.jsx)("p",{className:o().profileBio,children:u.bio||"自己紹介がありません。"}),(0,r.jsxs)("p",{className:o().profileJoined,children:["参加日: ",new Date(u.createdAt).toLocaleDateString()]})]}),(0,r.jsxs)("section",{className:o().postsSection,children:[(0,r.jsxs)("h3",{className:o().sectionTitle,children:[u.name||"このユーザー","の投稿"]}),u.posts.length>0?(0,r.jsx)(c.T,{posts:u.posts,onPostDeleted:()=>{x()}}):(0,r.jsx)("p",{className:o().noPostsMessage,children:"まだ投稿がありません。"})]})]})]}):(0,r.jsx)("div",{className:o().errorMessage,children:"ユーザーが見つかりませんでした。"})}},2324:function(e,s,t){"use strict";t.d(s,{T:function(){return u}});var r=t(7437),a=t(2265),l=t(8562),n=t.n(l),i=t(9361),o=t(8211),c=t(1310);let u=e=>{let{posts:s,onPostDeleted:t}=e,{showToast:l}=(0,o.p)(),{showPopover:u}=(0,c.t)(),[d,_]=(0,a.useState)(null),[p,m]=(0,a.useState)(null),[f,h]=(0,a.useState)(null);return((0,a.useEffect)(()=>{let e=localStorage.getItem("token");if(e)try{let s=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),t=JSON.parse(window.atob(s));_(t.userId)}catch(e){console.error("トークンのデコードに失敗しました",e),_(null)}},[s]),s&&0!==s.length)?(0,r.jsx)("div",{className:n().timelineContainer,children:s.map(e=>(0,r.jsx)(i.S,{post:e,onPostDeleted:t,currentUserId:d},e.id))}):(0,r.jsx)("div",{className:n().noPostsMessage,children:(0,r.jsx)("p",{children:"まだ投稿がありません。最初の投稿をしてみましょう！"})})}},9654:function(e){e.exports={container:"user_container__HUiag",header:"user_header__QSMzM",title:"user_title__V8bKx",backButton:"user_backButton__QiBru",mainContent:"user_mainContent__hZAFz",profileCard:"user_profileCard__m7_5Z",profileHeader:"user_profileHeader__Zx8hN",profileImage:"user_profileImage__K_tbS",profileName:"user_profileName__VWnEN",editButton:"user_editButton__K2Wy9",profileBio:"user_profileBio__QILzp",profileEmail:"user_profileEmail__b0vJj",profileJoined:"user_profileJoined__8IZ2M",postsSection:"user_postsSection___6aiX",sectionTitle:"user_sectionTitle__1G8Kd",noPostsMessage:"user_noPostsMessage__CtJ21",loadingMessage:"user_loadingMessage__YVw2L",errorMessage:"user_errorMessage__VXCrp"}}},function(e){e.O(0,[457,370,803,555,361,971,117,744],function(){return e(e.s=9903)}),_N_E=e.O()}]);