(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[797],{5393:function(e,s,a){Promise.resolve().then(a.bind(a,6314))},9376:function(e,s,a){"use strict";var t=a(5475);a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(s,{useSearchParams:function(){return t.useSearchParams}})},6314:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return u}});var t=a(7437),r=a(2265),n=a(9376),c=a(7648),l=a(2324),i=a(9531),o=a.n(i);function u(){let e=(0,n.useSearchParams)().get("q"),[s,a]=(0,r.useState)([]),[i,u]=(0,r.useState)([]),[_,h]=(0,r.useState)(!0),[d,m]=(0,r.useState)(null),[f,p]=(0,r.useState)("posts"),g=(0,r.useCallback)(async()=>{if(!e){h(!1),m("検索クエリがありません。");return}h(!0),m(null);try{let s=await fetch("/api/search/posts?q=".concat(encodeURIComponent(e)));if(s.ok){let e=await s.json();a(e)}else{let e=await s.json();m(e.error||"投稿検索結果の取得に失敗しました。")}let t=await fetch("/api/search/users?q=".concat(encodeURIComponent(e)));if(t.ok){let e=await t.json();u(e)}else{let e=await t.json();m(e.error||"ユーザー検索結果の取得に失敗しました。")}}catch(e){m("予期せぬエラーが発生しました。"),console.error(e)}finally{h(!1)}},[e]);return((0,r.useEffect)(()=>{g()},[g]),_)?(0,t.jsx)("div",{className:o().loadingMessage,children:"検索中..."}):d?(0,t.jsx)("div",{className:o().errorMessage,children:d}):(0,t.jsxs)("div",{className:o().container,children:[(0,t.jsxs)("h1",{className:o().title,children:['検索結果: "',e,'"']}),(0,t.jsxs)("div",{className:o().tabs,children:[(0,t.jsxs)("button",{className:"".concat(o().tabButton," ").concat("posts"===f?o().activeTab:""),onClick:()=>p("posts"),children:["投稿 (",s.length,")"]}),(0,t.jsxs)("button",{className:"".concat(o().tabButton," ").concat("users"===f?o().activeTab:""),onClick:()=>p("users"),children:["ユーザー (",i.length,")"]})]}),"posts"===f&&(0===s.length?(0,t.jsx)("p",{className:o().noResults,children:"該当する投稿は見つかりませんでした。"}):(0,t.jsx)(l.T,{posts:s,onPostDeleted:g})),"users"===f&&(0===i.length?(0,t.jsx)("p",{className:o().noResults,children:"該当するユーザーは見つかりませんでした。"}):(0,t.jsx)("div",{className:o().userList,children:i.map(e=>(0,t.jsx)("div",{className:o().userCard,children:(0,t.jsxs)(c.default,{href:"/users/".concat(e.id),className:o().userLink,children:[e.profileImageUrl&&(0,t.jsx)("img",{src:e.profileImageUrl,alt:"プロフィール画像",className:o().userProfileImage}),(0,t.jsxs)("div",{className:o().userInfo,children:[(0,t.jsx)("h3",{className:o().userName,children:e.name||"ユーザー ".concat(e.id)}),e.bio&&(0,t.jsx)("p",{className:o().userBio,children:e.bio})]})]})},e.id))}))]})}},2324:function(e,s,a){"use strict";a.d(s,{T:function(){return u}});var t=a(7437),r=a(2265),n=a(8562),c=a.n(n),l=a(9361),i=a(8211),o=a(1310);let u=e=>{let{posts:s,onPostDeleted:a}=e,{showToast:n}=(0,i.p)(),{showPopover:u}=(0,o.t)(),[_,h]=(0,r.useState)(null),[d,m]=(0,r.useState)(null),[f,p]=(0,r.useState)(null);return((0,r.useEffect)(()=>{let e=localStorage.getItem("token");if(e)try{let s=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),a=JSON.parse(window.atob(s));h(a.userId)}catch(e){console.error("トークンのデコードに失敗しました",e),h(null)}},[s]),s&&0!==s.length)?(0,t.jsx)("div",{className:c().timelineContainer,children:s.map(e=>(0,t.jsx)(l.S,{post:e,onPostDeleted:a,currentUserId:_},e.id))}):(0,t.jsx)("div",{className:c().noPostsMessage,children:(0,t.jsx)("p",{children:"まだ投稿がありません。最初の投稿をしてみましょう！"})})}},9531:function(e){e.exports={container:"search_container__iBLRa",title:"search_title__P57kX",loadingMessage:"search_loadingMessage__vfeHA",errorMessage:"search_errorMessage__iN3ti",noResults:"search_noResults__sOYXB",tabs:"search_tabs__IFRFW",tabButton:"search_tabButton__cjb_d",activeTab:"search_activeTab__HA41o",userList:"search_userList__7X9EV",userCard:"search_userCard__bimCb",userLink:"search_userLink__xDSvj",userProfileImage:"search_userProfileImage__oUgFp",userInfo:"search_userInfo__imvDu",userName:"search_userName__QwxQF",userEmail:"search_userEmail__xiwdG",userBio:"search_userBio__knK_Y"}}},function(e){e.O(0,[370,803,555,361,971,117,744],function(){return e(e.s=5393)}),_N_E=e.O()}]);